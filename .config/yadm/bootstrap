#!/bin/sh
set -e

# Remove legacy channels
nix-channel --list 2>/dev/null | cut -d' ' -f1 | xargs -r -I{} nix-channel --remove {}

# Apply home-manager configuration
nix run home-manager/release-25.11 -- switch --flake ~/.config/home-manager#root

# Switch to SSH remote
yadm remote set-url origin git@github.com:radutomy/dotnix.git
